# 程序化控制必需配置
# ============================================================
# 消除按键延迟 - 关键！send-keys 命令立即响应
set -sg escape-time 0

# 增大历史缓冲区 - capture-pane 可捕获更多输出
set -g history-limit 50000

# 终端类型设置 - 确保 256 色和 true color 支持
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc,xterm-256color:Tc"

# 启用自动重命名 - 让窗口名称反映当前运行的程序
set -g allow-rename on
set -g automatic-rename on
setw -g automatic-rename on

# 环境设置
# ============================================================
# 默认 shell
set-option -g default-command "bash -lc 'exec fish'"

# 窗口和窗格索引从 1 开始
set -g base-index 1
setw -g pane-base-index 1

# 自动重新编号窗口（删除窗口后保持连续编号）
set -g renumber-windows on

# 状态信息
# ============================================================
# 消息显示时间
set -g display-time 1000
set -g display-panes-time 2000

# 状态栏刷新间隔
set -g status-interval 10

# 状态栏主题 (精简版 gpakosz/.tmux 风格)
# ============================================================
set -g status-style "fg=#8a8a8a,bg=#080808"
set -g status-left-length 40
set -g status-left "#[fg=#080808,bg=#ffff00,bold] # #S #[default]"
set -g status-right-length 80
set -g status-right "#{?client_prefix,#[fg=#ffff00]^ ,}%R | %d %b #[fg=#e4e4e4,bg=#d70000,bold] #(whoami) #[fg=#080808,bg=#e4e4e4,bold] #H "
set -g window-status-separator ""
set -g window-status-format " #I #W "
set -g window-status-current-format "#[fg=#080808,bg=#00afff,bold] #I #W "
set -g pane-border-style "fg=#303030"
set -g pane-active-border-style "fg=#00afff"
set -g message-style "fg=#080808,bg=#ffff00,bold"

# 人工调试用快捷键
# ============================================================
# hjkl 窗格切换
bind -r k select-pane -U
bind -r j select-pane -D
bind -r h select-pane -L
bind -r l select-pane -R

# Ctrl+hjkl 调整窗格大小
bind -r ^k resizep -U 5
bind -r ^j resizep -D 5
bind -r ^h resizep -L 5
bind -r ^l resizep -R 5

# 交换窗格
bind ^u swapp -U
bind ^d swapp -D

# 切换窗口
bind -r C-p previous-window
bind -r C-n next-window

# 变量传递
# ============================================================
# 纯命令行环境 - 只保留 SSH 和终端相关变量
set -g update-environment "SSH_AUTH_SOCK SSH_AGENT_PID SSH_CONNECTION TERM"
