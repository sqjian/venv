# 程序化控制必需配置
# ============================================================
# 消除按键延迟 - 关键！send-keys 命令立即响应
set -sg escape-time 0

# 增大历史缓冲区 - capture-pane 可捕获更多输出
set -g history-limit 50000

# 终端类型设置 - 确保 256 色和 true color 支持
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc,xterm-256color:Tc"

# 禁用自动重命名 - 保持窗口/窗格名称稳定，便于程序定位
set -g allow-rename off
set -g automatic-rename off
setw -g automatic-rename off

# 环境设置
# ============================================================
# 默认 shell
set-option -g default-command "bash"

# 窗口和窗格索引从 1 开始
set -g base-index 1
setw -g pane-base-index 1

# 自动重新编号窗口（删除窗口后保持连续编号）
set -g renumber-windows on

# 窗格边框和状态信息
# ============================================================
# 窗格边框显示详细信息 - 便于调试和状态识别
set -g pane-border-status top
set -g pane-border-format " [#{pane_index}] #{pane_title} | PID:#{pane_pid} | #{pane_current_command} | #{?pane_dead,DEAD,ALIVE} "

# 消息显示时间
set -g display-time 1000
set -g display-panes-time 2000

# 状态栏刷新间隔
set -g status-interval 1

# 人工调试用快捷键
# ============================================================
# hjkl 窗格切换
bind -r k select-pane -U
bind -r j select-pane -D
bind -r h select-pane -L
bind -r l select-pane -R

# Ctrl+hjkl 调整窗格大小
bind -r ^k resizep -U 5
bind -r ^j resizep -D 5
bind -r ^h resizep -L 5
bind -r ^l resizep -R 5

# 交换窗格
bind ^u swapp -U
bind ^d swapp -D

# 切换窗口
bind -r C-p previous-window
bind -r C-n next-window

# 变量传递
# ============================================================
# 纯命令行环境 - 只保留 SSH 和终端相关变量
set -g update-environment "SSH_AUTH_SOCK SSH_AGENT_PID SSH_CONNECTION TERM"
